resilience4j:
  circuitbreaker:
    instances:
      media:
        slidingWindowSize: 10
        minimumNumberOfCalls: 5
        waitDurationInOpenState: 10s
        failureRateThreshold: 50
        permittedNumberOfCallsInHalfOpenState: 3
        eventConsumerBufferSize: 10
        registerHealthIndicator: true
  
  retry:
    instances:
      emailSend:
        maxAttempts: 3
        waitDuration: 1s
        exponentialBackoffMultiplier: 2
        enableExponentialBackoff: true
        retryExceptions:
          - org.springframework.mail.MailSendException
          - java.net.SocketTimeoutException
          - java.net.ConnectException
          - jakarta.mail.MessagingException
        ignoreExceptions:
          - org.springframework.mail.MailAuthenticationException

  ratelimiter:
    instances:
      # Auth
      authStrict:
        limitForPeriod: 20
        limitRefreshPeriod: 60s
        timeoutDuration: 0
        registerHealthIndicator: true
      authVeryStrict:
        limitForPeriod: 20
        limitRefreshPeriod: 1h
        timeoutDuration: 0
        registerHealthIndicator: true
      authModerate:
        limitForPeriod: 30
        limitRefreshPeriod: 60s
        timeoutDuration: 5s
        registerHealthIndicator: true

      #Media
      mediaSingle:
        limitForPeriod: 3
        limitRefreshPeriod: 5s
        timeoutDuration: 2s
        registerHealthIndicator: true
      mediaMultipart:
        limitForPeriod: 10
        limitRefreshPeriod: 20s
        timeoutDuration: 5s
        registerHealthIndicator: true

      # Swagger
      swagger:
        limitForPeriod: 100 # include file .js, .css, .ico,...
        limitRefreshPeriod: 60s
        timeoutDuration: 5s
        registerHealthIndicator: true

      # Public
      lowTraffic:
        limitForPeriod: 10
        limitRefreshPeriod: 30s
        timeoutDuration: 5s
        registerHealthIndicator: true
      mediumTraffic:
        limitForPeriod: 20
        limitRefreshPeriod: 30s
        timeoutDuration: 5s
        registerHealthIndicator: true
      highTraffic:
        limitForPeriod: 30
        limitRefreshPeriod: 30s
        timeoutDuration: 5s
        registerHealthIndicator: true